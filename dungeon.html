<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="style.css">
    <link rel="icon" href="Icons/favicon.ico" type="image/x-icon">
    <title>Search Dungeons</title>
</head>
<body>
    <h1>Search Dungeons</h1>
    <input type="text" id="searchBar" placeholder="Search for dungeons...">
    <input type="checkbox" name="id" id="id"><label for="id"> Search by ID</label>
    <div id="results"></div>

    <script>
        document.addEventListener('DOMContentLoaded', async () => {
            const searchBar = document.getElementById('searchBar');
            const results = document.getElementById('results');
            const id = document.getElementById('id');
            const jsonFiles = [
                'StrSheets/StrSheet_Dungeon/StrSheet_Dungeon-1.json'
                // Add more file names as needed
            ];

            let allData = [];
            async function fetchData(file) {
                try {
                    const response = await fetch(file);
                    const data = await response.json();
                    return data.dungeon;
                } catch (error) {
                    console.error(`Error fetching the JSON data from ${file}:`, error);
                    return [];
                }
            }

            // Fetch all JSON files
            for (const file of jsonFiles) {
                const fileData = await fetchData(file);
                allData = allData.concat(fileData);
            }
            function searching (){
                const searchTerm = searchBar.value.toLowerCase();
                results.innerHTML = '';
                allData.forEach(item => {
                    if (item.name){
                        if (id.checked && item.id.toLowerCase().includes(searchTerm)){
                            const div = document.createElement('div');
                            div.className = 'result';
                            div.innerHTML = `<div class="id">${item.id}</div><div class="info"><strong>${item.name}</strong></div>`;
                            results.appendChild(div);
                        }
                        else if (!id.checked && item.name.toLowerCase().includes(searchTerm)) {
                            const div = document.createElement('div');
                            div.className = 'result';
                            div.innerHTML = `<div class="id">${item.id}</div><div class="info"><strong>${item.name}</strong></div>`;
                            results.appendChild(div);
                        }
                    }
                });
            }

            searchBar.addEventListener('input', () => { searching() });
            id.addEventListener('change', () => { searching() });
        });
    </script>
</body>
</html>